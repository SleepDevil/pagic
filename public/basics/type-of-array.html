<html>
  <head>
    <title>数组的类型</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <aside>
      <nav>
        <ul>
          <li></li>
        </ul>
      </nav>
    </aside>
    <section>
      <article>
        <h1 id="%E6%95%B0%E7%BB%84%E7%9A%84%E7%B1%BB%E5%9E%8B">数组的类型</h1>
        <p>在 TypeScript 中，数组类型有多种定义方式，比较灵活。</p>
        <h2
          id="%E3%80%8C%E7%B1%BB%E5%9E%8B-%2B-%E6%96%B9%E6%8B%AC%E5%8F%B7%E3%80%8D%E8%A1%A8%E7%A4%BA%E6%B3%95"
        >
          「类型 + 方括号」表示法
        </h2>
        <p>最简单的方法是使用「类型 + 方括号」来表示数组：</p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">let</span> fibonacci<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
        <p>数组的项中<strong>不允许</strong>出现其他的类型：</p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">let</span> fibonacci<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Type 'string' is not assignable to type 'number'.</span>
</code></pre>
        <p>数组的一些方法的参数也会根据数组在定义时约定的类型进行限制：</p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">let</span> fibonacci<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
fibonacci<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Argument of type '"8"' is not assignable to parameter of type 'number'.</span>
</code></pre>
        <p>
          上例中，<code>push</code> 方法只允许传入
          <code>number</code> 类型的参数，但是却传了一个
          <code>&quot;8&quot;</code> 类型的参数，所以报错了。这里
          <code>&quot;8&quot;</code>
          是一个字符串字面量类型，会在后续章节中详细介绍。
        </p>
        <h2 id="%E6%95%B0%E7%BB%84%E6%B3%9B%E5%9E%8B">数组泛型</h2>
        <p>
          我们也可以使用数组泛型（Array Generic）
          <code>Array&lt;elemType&gt;</code> 来表示数组：
        </p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">let</span> fibonacci<span class="token punctuation">:</span> <span class="token keyword">Array</span><span class="token operator">&lt;</span><span class="token keyword">number</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
        <p>
          关于泛型，可以参考<a href="../advanced/generics.html">泛型</a>一章。
        </p>
        <h2
          id="%E7%94%A8%E6%8E%A5%E5%8F%A3%E8%A1%A8%E7%A4%BA%E6%95%B0%E7%BB%84"
        >
          用接口表示数组
        </h2>
        <p>接口也可以用来描述数组：</p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">NumberArray</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>index<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> fibonacci<span class="token punctuation">:</span> NumberArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
        <p>
          <code>NumberArray</code>
          表示：只要索引的类型是数字时，那么值的类型必须是数字。
        </p>
        <p>
          虽然接口也可以用来描述数组，但是我们一般不会这么做，因为这种方式比前两种方式复杂多了。
        </p>
        <p>不过有一种情况例外，那就是它常用来表示类数组。</p>
        <h2 id="%E7%B1%BB%E6%95%B0%E7%BB%84">类数组</h2>
        <p>
          类数组（Array-like Object）不是数组类型，比如 <code>arguments</code>：
        </p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> args<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Type 'IArguments' is missing the following properties from type 'number[]': pop, push, concat, join, and 24 more.</span>
</code></pre>
        <p>
          上例中，<code>arguments</code>
          实际上是一个类数组，不能用普通的数组的方式来描述，而应该用接口：
        </p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> args<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>index<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">;</span>
        length<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">;</span>
        callee<span class="token punctuation">:</span> <span class="token keyword">Function</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        <p>
          在这个例子中，我们除了约束当索引的类型是数字时，值的类型必须是数字之外，也约束了它还有
          <code>length</code> 和 <code>callee</code> 两个属性。
        </p>
        <p>
          事实上常用的类数组都有自己的接口定义，如 <code>IArguments</code>,
          <code>NodeList</code>, <code>HTMLCollection</code> 等：
        </p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> args<span class="token punctuation">:</span> IArguments <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        <p>
          其中 <code>IArguments</code> 是 TypeScript
          中定义好了的类型，它实际上就是：
        </p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">IArguments</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>index<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">;</span>
    length<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">;</span>
    callee<span class="token punctuation">:</span> <span class="token keyword">Function</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        <p>
          关于内置对象，可以参考<a href="./built-in-objects.html">内置对象</a
          >一章。
        </p>
        <h2
          id="any-%E5%9C%A8%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"
        >
          any 在数组中的应用
        </h2>
        <p>
          一个比较常见的做法是，用 <code>any</code> 表示数组中允许出现任意类型：
        </p>
        <pre
          class="language-ts"
        ><code class="language-ts"><span class="token keyword">let</span> list<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'xcatliu'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> website<span class="token punctuation">:</span> <span class="token string">'http://xcatliu.com'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
        <h2 id="%E5%8F%82%E8%80%83">参考</h2>
        <ul>
          <li>
            <a
              href="http://www.typescriptlang.org/docs/handbook/basic-types.html#array"
              >Basic Types # Array</a
            >（<a
              href="https://zhongsp.gitbooks.io/typescript-handbook/content/doc/handbook/Basic%20Types.html#%E6%95%B0%E7%BB%84"
              >中文版</a
            >）
          </li>
          <li>
            <a
              href="http://www.typescriptlang.org/docs/handbook/interfaces.html#indexable-types"
              >Interfaces # Indexable Types</a
            >（<a
              href="https://zhongsp.gitbooks.io/typescript-handbook/content/doc/handbook/Interfaces.html#%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B"
              >中文版</a
            >）
          </li>
        </ul>
        <hr />
        <ul>
          <li>
            <a href="type-of-object-interfaces.html"
              >上一章：对象的类型——接口</a
            >
          </li>
          <li><a href="type-of-function.html">下一章：函数的类型</a></li>
        </ul>
      </article>
    </section>
  </body>
</html>
